/*!
 * Formaat 0.0.1
 * Copyright 2017 Rajiv Raman (https://www.linkedin.com/in/rajivraman/)
 * Licensed under MIT (http://opensource.org/licenses/MIT)
 */

!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof module&&module.exports?module.exports=b():a.formaat=b()}(this,function(){"use strict";var a=function(b){if(!(this instanceof a))return new a(b);if(!((b=parseFloat(b))>0))throw new Error('"numChars" argument must be an int or float greater than zero');this.numChars=b};return a.prototype.abbrev=function(a,b){if(b||(b=a),!isFinite(a=parseFloat(a)))return console.log("formatNumber; invalid pNum: "+a),a;var c=function(a){return a.length-.5*(a.match(/[,\.]/g)||[]).length},d=function(a){var b=a.indexOf(".");return c(b>=0?a.substr(0,b):a)},e=a.toLocaleString("en-US",{maximumFractionDigits:20}),f=c(e);if(f<=this.numChars)return e;Number.isInteger=Number.isInteger||function(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a};var g,h,i=Number.isInteger(a),j=!i;if(j&&(g=f-(e.length-e.indexOf(".")-1)-.5)<=this.numChars){if(h=Math.floor(this.numChars-g-.5),h=Math.max(0,h),e=a.toLocaleString("en-US",{maximumFractionDigits:h}),d(e)!=g){var k=Math.round(a);return this.abbrev(k,a)}return e}var l=Math.abs(a),m=null,n="",o=null;if(l<1e3)m=a/1e3,o=1e3,n="K";else if(l<1e6)m=a/1e3,o=1e3,n="K";else if(l<1e9)m=a/1e6,o=1e6,n="M";else{if(!(l<1e12))return"1T+";m=a/1e9,o=1e9,n="B"}var p=this.numChars-n.length;if(g=Math.floor(m).toString().length,h=Math.floor(p-g-.5),h=Math.max(0,h),e=m.toLocaleString("en-US",{maximumFractionDigits:h}),d(e)!=g){var q=Math.round(m)*o;return this.abbrev(q,a)}return g<=p&&"0"!==e?e+n:(console.log("formatNumber; bad params: "+b+", "+this.numChars),b.toString().substr(0,this.numChars-1)+"~")},a});